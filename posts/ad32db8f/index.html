<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>KMP | Wantropy's Space</title><meta name="author" content="Wan &amp; An"><meta name="copyright" content="Wan &amp; An"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="KMP is a string matching algorithm that is used to find a substring in a string. It is an efficient algorithm that has a time complexity of O(n+m) where n is the length of the string and m is the leng">
<meta property="og:type" content="article">
<meta property="og:title" content="KMP">
<meta property="og:url" content="http://blog.wantropy.com/posts/ad32db8f/index.html">
<meta property="og:site_name" content="Wantropy&#39;s Space">
<meta property="og:description" content="KMP is a string matching algorithm that is used to find a substring in a string. It is an efficient algorithm that has a time complexity of O(n+m) where n is the length of the string and m is the leng">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://blog.wantropy.com/imgs/avatar.png">
<meta property="article:published_time" content="2024-07-23T03:23:02.000Z">
<meta property="article:modified_time" content="2024-07-23T07:16:59.319Z">
<meta property="article:author" content="Wan &amp; An">
<meta property="article:tag" content="leetcode">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.wantropy.com/imgs/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.wantropy.com/posts/ad32db8f/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'KMP',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-07-23 00:16:59'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/imgs/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: linear-gradient(45deg, #00c6ff, #0072ff, #00d4ff, #72edf2)"><nav id="nav"><span id="blog-info"><a href="/" title="Wantropy's Space"><span class="site-name">Wantropy's Space</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">KMP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-07-23T03:23:02.000Z" title="Created 2024-07-22 20:23:02">2024-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-07-23T07:16:59.319Z" title="Updated 2024-07-23 00:16:59">2024-07-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="KMP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="KMP-Algorithm"><a href="#KMP-Algorithm" class="headerlink" title="KMP Algorithm"></a>KMP Algorithm</h1><h2 id="What-is-KMP"><a href="#What-is-KMP" class="headerlink" title="What is KMP?"></a>What is KMP?</h2><p>KMP is a string matching algorithm that is used to find a substring in a string. It is an efficient algorithm that has a time complexity of O(n+m) where n is the length of the string and m is the length of the substring.</p>
<p>KMP 是一个解决 模式串在文本串中是否出现过，如果出现过，则最早出现的位置的经典算法。KMP 算法的时间复杂度是 O(n+m)。</p>
<blockquote>
<p>For Internal Use:</p>
</blockquote>
<div class="hide-block"><button type="button" class="hide-button" style="">查看红包兑换码
    </button><div class="hide-content"><p>老安是我爸爸</p>
</div></div>

<span id="more"></span>

<h2 id="Leetcode-Links"><a href="#Leetcode-Links" class="headerlink" title="Leetcode Links"></a>Leetcode Links</h2><p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/find-the-index-of-the-first-occurrence-in-a-string/?envType=study-plan-v2&envId=top-interview-150">28. Find the index of the first ocurence in a string</a></p>
<h3 id="Problem-description"><a href="#Problem-description" class="headerlink" title="Problem description"></a>Problem description</h3><p>Given two strings needle and haystack, return the index of the first occurrence of needle in haystack, or -1 if needle is not part of haystack.</p>
<p><code>Example 1</code>:</p>
<blockquote>
<p>Input: haystack &#x3D; “sadbutsad”, needle &#x3D; “sad”<br>Output: 0<br>Explanation: “sad” occurs at index 0 and 6.<br>The first occurrence is at index 0, so we return 0.</p>
</blockquote>
<p><code>Example 2</code>:</p>
<blockquote>
<p>Input: haystack &#x3D; “leetcode”, needle &#x3D; “leeto”<br>Output: -1<br>Explanation: “leeto” did not occur in “leetcode”, so we return -1.</p>
</blockquote>
<p><code>Constraints</code>:<br>1 &lt;&#x3D; haystack.length, needle.length &lt;&#x3D; 104<br>haystack and needle consist of only lowercase English characters.</p>
<h2 id="KMP-Algorithm-1"><a href="#KMP-Algorithm-1" class="headerlink" title="KMP Algorithm"></a>KMP Algorithm</h2><h3 id="KMP-working-analysis"><a href="#KMP-working-analysis" class="headerlink" title="KMP working analysis"></a>KMP working analysis</h3><p>Take this as an example:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 <span class="operator">=</span> <span class="string">&quot;ABCDAB ABCDABCDABDE&quot;</span></span><br><span class="line"><span class="keyword">let</span> s2 <span class="operator">=</span> <span class="string">&quot;ABCDABD&quot;</span></span><br></pre></td></tr></table></figure>
<p>A brute force solution would be to compare each character of <code>s1</code> with <code>s2</code> and if a mismatch is found, we start comparing from the next character of <code>s1</code> with the start of <code>s2</code>. This will be inefficient as we are not utilizing the information that we already know in previous loops. i.e. from the example above, we have walked through the first 6 characters of <code>s1</code> before we reach the last <code>D</code> in <code>s2</code>, which is the mismatch, 7th character of both, so the next position we should comare with <code>s2</code>‘s first character is not the 2nd character of <code>s1</code> because we know the 2nd character of <code>s1</code> is <code>B</code> and <code>B</code> is not equal to <code>A</code>. </p>
<p>We should instead skip as many characters as possible to avoid unnecessary comparisons. How do we do that? We need to build a table that tells us how many characters we can skip when a mismatch is found. That table will tell us that we should jump to the 5th character of <code>s1</code> to continue the compare because we know the last two characters of <code>s1</code> are <code>AB</code> and <code>AB</code> is equal to <code>AB</code> in <code>s2</code>, which is the first two characters of <code>s2</code>, which means we can possibly find a match from the 5th character of <code>s1</code> (but not guaranteed, still need to compare all the rest characters of <code>s2</code> with <code>s1</code>).</p>
<blockquote>
<p>此时回溯时，A 还会去和 BCD 进行比较，而在上一步 ABCDAB 与 ABCDABD，前 6 个都相等，其中 BCD 搜索词的第一个字符 A 不相等，那么这个时候还要用 A 去匹配 BCD，这肯定会匹配失败。<br>KMP 算法的想法是：设法利用这个已知信息，不要把「搜索位置」移回已经比较过的位置，继续把它向后移，这样就提高了效率。<br>那么新的问题就来了：你如何知道 A 与 BCD 不相同，并且只有 BCD 不用比较呢？这个就是 KMP 的核心原理了。<br>KMP 利用 部分匹配表，来省略掉刚刚重复的步骤。<br>匹配表应该告诉我们：<br>ABCD 匹配值 0<br>ABCDA 匹配值 1<br>ABCDAB 匹配值 2<br>已知空格与 D 不匹配时，前面 6 个字符 ABCDAB 是匹配的。<br>查表可知：部分匹配值是 2，因此按照下面的公司计算出后移的位数：<br>移动位数 &#x3D; 已匹配的字符数 - 对应的部分匹配值<br>4      &#x3D;    6		  -   2<br>因此回溯的时候往后移动 4 位，而不是暴力匹配移动的 1 位。</p>
</blockquote>
<h3 id="How-to-build-the-table"><a href="#How-to-build-the-table" class="headerlink" title="How to build the table"></a>How to build the table</h3><p>The table is expected to tell us the partial match value of the substring. The partial match value is the length of the longest proper prefix of the substring that is also a proper suffix of the substring.<br>The following table shows the partial match value of the substring <code>ABCDABD</code>:</p>
<blockquote>
<p>Note the prefix should exclude the last character of the substring and the suffix should exclude the first character of the substring.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Substring</th>
<th>Prefix</th>
<th>Suffix</th>
<th>Common Prefix and Suffix</th>
<th>Partial Match Value</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>AB</td>
<td>A</td>
<td>B</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>ABC</td>
<td>A, AB</td>
<td>BC, C</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>ABCD</td>
<td>A, AB, ABC</td>
<td>BCD, CD, D</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>ABCDA</td>
<td>A, AB, ABC, ABCD</td>
<td>BCDA, CDA, DA, A</td>
<td>A</td>
<td>1</td>
</tr>
<tr>
<td>ABCDAB</td>
<td>A, AB, ABC, ABCD, ABCDA</td>
<td>BCDAB, CDAB, DAB, AB, B</td>
<td>AB</td>
<td>2</td>
</tr>
</tbody></table>
<h3 id="Implementation-steps"><a href="#Implementation-steps" class="headerlink" title="Implementation steps"></a>Implementation steps</h3><ol>
<li>Build the table</li>
<li>Use the table to complete the KMP matching algorithm</li>
</ol>
<h4 id="Build-the-table"><a href="#Build-the-table" class="headerlink" title="Build the table"></a>Build the table</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">String</span> &#123;</span><br><span class="line">    <span class="comment">/// Altorighm: KMP</span></span><br><span class="line">    <span class="comment">///</span></span><br><span class="line">    <span class="comment">/// Building the dictionary lps:</span></span><br><span class="line">    <span class="comment">/// Name lps indicates the longest proper prefix which is also a suffix.</span></span><br><span class="line">    <span class="comment">/// ABCDAB -&gt; [0, 0, 0, 0, 1, 2]</span></span><br><span class="line">    <span class="keyword">var</span> lps: [<span class="type">Int</span>] &#123;</span><br><span class="line">        <span class="keyword">var</span> result <span class="operator">=</span> [<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">var</span> s <span class="operator">=</span> <span class="type">Array</span>(<span class="keyword">self</span>)</span><br><span class="line">        <span class="keyword">var</span> commonFromStart <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span><span class="operator">..&lt;</span>s.count &#123;</span><br><span class="line">            <span class="keyword">if</span> s[i] <span class="operator">==</span> s[commonFromStart] &#123;</span><br><span class="line">                commonFromStart <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            result.append(commonFromStart)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// print(&quot;lps: \(self) -&gt; \(result)&quot;)</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Use-the-table"><a href="#Use-the-table" class="headerlink" title="Use the table"></a>Use the table</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">strStr</span>(<span class="keyword">_</span> <span class="params">haystack</span>: <span class="type">String</span>, <span class="keyword">_</span> <span class="params">needle</span>: <span class="type">String</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="comment">// check if the haystack is long enough to contain the needle</span></span><br><span class="line">        <span class="keyword">guard</span> haystack.count <span class="operator">&gt;=</span> needle.count <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="operator">-</span><span class="number">1</span> &#125;</span><br><span class="line">        <span class="comment">// convert the strings to arrays for easy manipulation</span></span><br><span class="line">        <span class="keyword">var</span> haystack <span class="operator">=</span> <span class="type">Array</span>(haystack), needle <span class="operator">=</span> <span class="type">Array</span>(needle)</span><br><span class="line">        <span class="comment">// hi: haystack index, ni: needle index</span></span><br><span class="line">        <span class="keyword">var</span> hi <span class="operator">=</span> <span class="number">0</span>, ni <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="comment">// loop through the haystack until index of the last possible match</span></span><br><span class="line">        <span class="keyword">while</span> hi <span class="operator">+</span> needle.count <span class="operator">&lt;=</span> haystack.count &#123;</span><br><span class="line">            <span class="comment">// print(&quot;hi: \(hi), ni: \(ni)&quot;)</span></span><br><span class="line">            <span class="comment">// if ni is 0 and the characters are not equal, jump hi by 1 because there has been no match yet (ni == 0)</span></span><br><span class="line">            <span class="keyword">if</span> ni <span class="operator">==</span> <span class="number">0</span> <span class="operator">&amp;&amp;</span> needle[ni] <span class="operator">!=</span> haystack[hi] &#123;</span><br><span class="line">                hi <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> needle[ni] <span class="operator">==</span> haystack[hi <span class="operator">+</span> ni] &#123;</span><br><span class="line">                <span class="comment">// if the current character in needle matches the character in haystack, and ni is the last index of needle, return hi because we have found the first occurrence of needle in haystack</span></span><br><span class="line">                <span class="keyword">if</span> ni <span class="operator">==</span> needle.count <span class="operator">-</span> <span class="number">1</span> &#123; <span class="keyword">return</span> hi &#125;</span><br><span class="line">                <span class="comment">// otherwise, increment ni to continue the comparison for the next character in both strings</span></span><br><span class="line">                ni <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// mismatch happens, jump hi and reset ni</span></span><br><span class="line">            <span class="keyword">let</span> lps <span class="operator">=</span> <span class="type">String</span>(haystack[hi<span class="operator">...</span>hi <span class="operator">+</span> ni]).lps</span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> match <span class="operator">=</span> lps.last <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="operator">-</span><span class="number">1</span> &#125;</span><br><span class="line">            <span class="comment">// this is calculated based on the lps table mentioned above: 移动位数 = 已匹配的字符数 - 对应的部分匹配值</span></span><br><span class="line">            <span class="keyword">let</span> jump <span class="operator">=</span> lps.count <span class="operator">-</span> match</span><br><span class="line">            hi <span class="operator">+=</span> jump</span><br><span class="line">            ni <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">            <span class="comment">// print(&quot;hi jump: \(jump) -&gt; hi: \(hi), ni: \(ni)&quot;)</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Leetcode-submission-result"><a href="#Leetcode-submission-result" class="headerlink" title="Leetcode submission result"></a>Leetcode submission result</h2><p><img src="/posts/ad32db8f/p28.png"></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://zq99299.github.io/dsalg-tutorial/dsalg-java-hsp/14/04.html#kmp-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90">KMP 算法</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://blog.wantropy.com">Wan &amp; An</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://blog.wantropy.com/posts/ad32db8f/">http://blog.wantropy.com/posts/ad32db8f/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/leetcode/">leetcode</a><a class="post-meta__tags" href="/tags/algorithm/">algorithm</a></div><div class="post_share"><div class="social-share" data-image="/imgs/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/a5795f36/" title="观intern demo有感"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">观intern demo有感</div></div></a></div><div class="next-post pull-right"><a href="/posts/940071c4/" title="Jul Leetcode"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">Jul Leetcode</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/posts/940071c4/" title="Jul Leetcode"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-21</div><div class="title">Jul Leetcode</div></div></a></div><div><a href="/posts/dc9314c3/" title="DFS"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-03</div><div class="title">DFS</div></div></a></div><div><a href="/posts/948699bb/" title="Handle Arrays"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-23</div><div class="title">Handle Arrays</div></div></a></div><div><a href="/posts/1fa0e526/" title="dictionary"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-07</div><div class="title">dictionary</div></div></a></div><div><a href="/posts/319b9e70/" title="attributes"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-07</div><div class="title">attributes</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/imgs/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wan &amp; An</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#KMP-Algorithm"><span class="toc-number">1.</span> <span class="toc-text">KMP Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-KMP"><span class="toc-number">1.1.</span> <span class="toc-text">What is KMP?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Leetcode-Links"><span class="toc-number">1.2.</span> <span class="toc-text">Leetcode Links</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-description"><span class="toc-number">1.2.1.</span> <span class="toc-text">Problem description</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KMP-Algorithm-1"><span class="toc-number">1.3.</span> <span class="toc-text">KMP Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP-working-analysis"><span class="toc-number">1.3.1.</span> <span class="toc-text">KMP working analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-build-the-table"><span class="toc-number">1.3.2.</span> <span class="toc-text">How to build the table</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementation-steps"><span class="toc-number">1.3.3.</span> <span class="toc-text">Implementation steps</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-the-table"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">Build the table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-the-table"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">Use the table</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Leetcode-submission-result"><span class="toc-number">1.4.</span> <span class="toc-text">Leetcode submission result</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">2.</span> <span class="toc-text">Reference</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/1fa0e526/" title="dictionary">dictionary</a><time datetime="2024-08-08T04:47:43.592Z" title="Updated 2024-08-07 21:47:43">2024-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/ea6d3435/" title="memory">memory</a><time datetime="2024-08-08T04:47:33.385Z" title="Updated 2024-08-07 21:47:33">2024-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/319b9e70/" title="attributes">attributes</a><time datetime="2024-08-08T04:43:14.248Z" title="Updated 2024-08-07 21:43:14">2024-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/948699bb/" title="Handle Arrays">Handle Arrays</a><time datetime="2024-08-06T05:39:43.027Z" title="Updated 2024-08-05 22:39:43">2024-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/dc9314c3/" title="DFS">DFS</a><time datetime="2024-08-04T06:38:01.344Z" title="Updated 2024-08-03 23:38:01">2024-08-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Wan & An</div><div class="footer_custom_text">Welcome to my blog.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const disqus_config = function () {
    this.page.url = 'http://blog.wantropy.com/posts/ad32db8f/'
    this.page.identifier = '/posts/ad32db8f/'
    this.page.title = 'KMP'
  }

  const disqusReset = () => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addGlobalFn('themeChange', disqusReset, 'disqus')

  const loadDisqus = () =>{
    if (window.DISQUS) disqusReset()
    else {
      const script = document.createElement('script')
      script.src = 'https://blog-wantropy-com.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=blog-wantropy-com&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if ('Disqus' === 'Disqus' || !false) {
    if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="true" data-text="爱国,守法,明礼,诚信" data-fontsize="11px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>